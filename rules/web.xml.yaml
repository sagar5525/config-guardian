# rules/web.xml.yaml
rules:
  - id: "WEBXML-001"
    name: "Directory Listing Enabled"
    description: "Default servlet allows directory browsing."
    type: "xpath"
    xpath: "//ns:servlet[ns:servlet-name[text()='default']]/ns:init-param[ns:param-name[text()='listings']]/ns:param-value[text()='true']"
    condition: "exists"
    severity: "Medium"
    remediation: "Set <param-value>false</param-value> or remove."
    reference: "https://owasp.org/www-community/attacks/Directory_listing"

  - id: "WEBXML-002"
    name: "Session Timeout Not Set"
    description: "Session timeout not configured, risking prolonged exposure."
    type: "xpath"
    xpath: "//ns:session-config/ns:session-timeout"
    condition: "not(exists)"
    severity: "Medium"
    remediation: "Set <session-timeout>15</session-timeout> (minutes)."
    reference: "https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html"

  - id: "WEBXML-003"
    name: "Error Page Not Custom"
    description: "Default error pages may leak stack traces."
    type: "xpath"
    xpath: "//ns:error-page"
    condition: "not(exists)"
    severity: "Low"
    remediation: "Define custom error-page for 404, 500, etc."
    reference: "https://owasp.org/www-community/vulnerabilities/Information_exposure_through_an_error_message"

  - id: "WEBXML-004"
    name: "Security Constraint Missing"
    description: "No security constraints defined for sensitive paths."
    type: "xpath"
    xpath: "//ns:security-constraint"
    condition: "not(exists)"
    severity: "High"
    remediation: "Add security-constraint to protect admin paths with auth."
    reference: "https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2021/Top_ten_2021-A01-Broken_Access_Control"
