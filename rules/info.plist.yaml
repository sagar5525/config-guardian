rules:
  - id: "PLIST-001"
    name: "App Transport Security Disabled"
    description: "NSAllowsArbitraryLoads set to true, allowing HTTP traffic."
    type: "key"
    key: "NSAppTransportSecurity.NSAllowsArbitraryLoads"
    value: "true"
    severity: "High"
    remediation: "Set to false and allow only trusted domains."
    reference: "https://developer.apple.com/documentation/bundleresources/information_property_list/nsapptransportsecurity"

  - id: "PLIST-002"
    name: "Keychain Sharing Enabled"
    description: "Keychain sharing may expose sensitive credentials."
    type: "key"
    key: "keychain-access-groups"
    condition: "exists"
    severity: "Medium"
    remediation: "Disable unless required for app groups."
    reference: "https://developer.apple.com/documentation/security/keychain_services"

  - id: "PLIST-003"
    name: "UIFileSharingEnabled"
    description: "File sharing enabled, exposing app documents to users."
    type: "key"
    key: "UIFileSharingEnabled"
    value: "true"
    severity: "Low"
    remediation: "Set UIFileSharingEnabled to false unless needed."
    reference: "https://developer.apple.com/documentation/bundleresources/information_property_list/uifilesharingenabled"

  - id: "PLIST-004"
    name: "Associated Domains Not Validated"
    description: "Universal Links not properly validated with apple-app-site-association."
    type: "key"
    key: "com.apple.developer.associated-domains"
    condition: "exists"
    severity: "Medium"
    remediation: "Ensure domain has valid apple-app-site-association file."
    reference: "https://developer.apple.com/documentation/safariservices/supporting_associated_domains"
